<!DOCTYPE html>
<html>
<head>   
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

		<title>Dewhurst Security Blog - Introduction to the WordPress XML-RPC API</title>
    <meta name="description" content="WordPress 3.5 was recently released which now comes with the WordPress API "always enabled". Personally I think this adds unnecessary risk by increasing the ...">

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="home-template">

    
    <main class="content" role="main">

    <article class="post">
        <header class="post-header">
            <a id="blog-logo" href="http://blog.dewhurstsecurity.com">
                
                    <span class="blog-title">Dewhurst Security Blog</span>
                 
            </a>
        </header>
        
        <span class="post-meta">
        	<time datetime="2012-12-11">11 Dec 2012</time>
        	
        		on
	        	
	        
       	</span>

        <h1 class="post-title">Introduction to the WordPress XML-RPC API</h1>

        <section class="post-content">
            <p>WordPress 3.5 was recently released which now comes with the WordPress API "always enabled". Personally I think this adds unnecessary risk by increasing the attack surface. How many WordPress user's actually use the API? I would put my money on it being a very small fraction, either way I'm sure the WordPress Core Development team had good reason to enable the API by default. After spending 5 minutes looking for where to turn the API off in WordPress 3.5 I gave up. Huh, I'll have another look sometime soon.</p>

<p>I've had a play with the API in the past, however, I've always found it hard to get going as the information on how to interact with the API is a bit sparse. Having played with it for an hour or so this evening I thought I'd share some of the information on how to get started (as well as a self reminder ;).</p>

<p>The latest API calls can be found on WordPress's Codex <a href="http://codex.wordpress.org/XML-RPC_WordPress_API" target="_blank">here</a>. It doesn't list all available calls, to find these let's extract them from the 'wp-includes/class-wp-xmlrpc-server.php' file.</p>

<p><a id="more"></a><a id="more-16894"></a></p>

<p>
<div class="highlight"><pre><code class="language-text" data-lang="text">wp.getUsersBlogs
wp.newPost
wp.editPost
wp.deletePost
wp.getPost
wp.getPosts
wp.newTerm
wp.editTerm
wp.deleteTerm
wp.getTerm
wp.getTerms
wp.getTaxonomy
wp.getTaxonomies
wp.getUser
wp.getUsers
wp.getProfile
wp.editProfile
wp.getPage
wp.getPages
wp.newPage
wp.deletePage
wp.editPage
wp.getPageList
wp.getAuthors
wp.getCategories
wp.getTags
wp.newCategory
wp.deleteCategory
wp.suggestCategories
wp.uploadFile
wp.getCommentCount
wp.getPostStatusList
wp.getPageStatusList
wp.getPageTemplates
wp.getOptions
wp.setOptions
wp.getComment
wp.getComments
wp.deleteComment
wp.editComment
wp.newComment
wp.getCommentStatusList
wp.getMediaItem
wp.getMediaLibrary
wp.getPostFormats
wp.getPostType
wp.getPostTypes
wp.getRevisions
wp.restoreRevision
blogger.getUsersBlogs
blogger.getUserInfo
blogger.getPost
blogger.getRecentPosts
blogger.newPost
blogger.editPost
blogger.deletePost
metaWeblog.newPost
metaWeblog.editPost
metaWeblog.getPost
metaWeblog.getRecentPosts
metaWeblog.getCategories
metaWeblog.newMediaObject
metaWeblog.deletePost
metaWeblog.getUsersBlogs
mt.getCategoryList
mt.getRecentPostTitles
mt.getPostCategories
mt.setPostCategories
mt.supportedMethods
mt.supportedTextFilters
mt.getTrackbackPings
mt.publishPost
pingback.ping
pingback.extensions.getPingbacks
demo.sayHello
demo.addTwoNumbers
system.getCapabilities # Incutio XML-RPC Library call - added 17.06.2013
system.listMethods # Incutio XML-RPC Library call - added 17.06.2013
system.multicall # Incutio XML-RPC Library call - added 17.06.2013</code></pre></div>
</p>

<p>As you can see from the above list there are a whole host of different things you can do via the API. Creating blog posts, requesting information about the blog's settings and even uploading media! Most of these require authentication and use the same authorisation mechanisms as the GUI. The three I found not to require authentication were pingback.ping, demo.sayHello and demo.addTwoNumbers (there are probably others).  </p>

<p>A typical API request body looks like the following:</p>

<p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
  <span class="nt">&lt;methodName&gt;</span>demo.sayHello<span class="nt">&lt;/methodName&gt;</span>
  <span class="nt">&lt;params&gt;</span>
   <span class="nt">&lt;param&gt;&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span></code></pre></div>
</p>

<p>The xmlrpc.php file needs the valid XML sent to it as a POST request. The easiest way to do this in Linux is to use <a href="http://curl.haxx.se/" target="_blank">cURL</a>. The following command will send the XML contained within the 'demo.sayHello.txt' file as a POST request to the remote WordPress API:</p>

<p>
<div class="highlight"><pre><code class="language-text" data-lang="text">curl --data @demo.sayHello.txt http://www.example.com/xmlrpc.php</code></pre></div>
</p>

<p>Which should return a response that looks like this:</p>

<p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;methodResponse&gt;</span>
  <span class="nt">&lt;params&gt;</span>
    <span class="nt">&lt;param&gt;</span>
      <span class="nt">&lt;value&gt;</span>
      <span class="nt">&lt;string&gt;</span>Hello!<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodResponse&gt;</span></code></pre></div>
</p>

<p>Simple, eh?</p>

<p>Here are a few other WordPress API calls:</p>

<p>demo.addTwoNumbers<br />

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
  <span class="nt">&lt;methodName&gt;</span>demo.addTwoNumbers<span class="nt">&lt;/methodName&gt;</span>
  <span class="nt">&lt;params&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>2.0E+72<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>2.0E+72<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span></code></pre></div>
</p>

<p>pingback.ping<br />

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
  <span class="nt">&lt;methodName&gt;</span>pingback.ping<span class="nt">&lt;/methodName&gt;</span>
  <span class="nt">&lt;params&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;&lt;string&gt;</span>http://www.example.com/index.php?p=71<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;&lt;string&gt;</span>http://www.example2.com/index.php?p=72<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span></code></pre></div>
</p>

<p>wp.getPost<br />

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
  <span class="nt">&lt;methodName&gt;</span>wp.getPost<span class="nt">&lt;/methodName&gt;</span>
  <span class="nt">&lt;params&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>1<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>username<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>password<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>72<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span></code></pre></div>
</p>

<p>wp.getUsers<br />

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
  <span class="nt">&lt;methodName&gt;</span>wp.getUsers<span class="nt">&lt;/methodName&gt;</span>
  <span class="nt">&lt;params&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>1<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>username<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
   <span class="nt">&lt;param&gt;&lt;value&gt;</span>password<span class="nt">&lt;/value&gt;&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span></code></pre></div>
</p>

<p>There you are, something to get you started playing around with the WordPress API. If you find out how to turn the damn thing off let me know! :)</p>

<p>EDIT ---</p>

<p>After reading this post long time WPScan contributor (<a href="https://twitter.com/_FireFart_" target="_blank">@_FireFart_</a>) wrote a port scanner using a remote WordPress API! - <a href="https://github.com/FireFart/WordpressPingbackPortScanner" target="_blank">https://github.com/FireFart/WordpressPingbackPortScanner</a></p>

<p>EDIT: 06.01.2013 00:55</p>

<p>An even more serious issue has been identified with WordPress's XMLRPC API. ONsec research lab have found that the pingback API is vulnerable to 'SSRF' (Server Side Request Forgery): <a href="http://lab.onsec.ru/2013/01/wordpress-xmlrpc-pingback-additional.html" target="_blank">http://lab.onsec.ru/2013/01/wordpress-xmlrpc-pingback-additional.html</a></p>

        </section>

        

        <footer class="post-footer">
            <section class="hire-me">
              <h4><a href="http://dewhurstsecurity.com/">Dewhurst Security</a></h4>
            </section>                

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Introduction to the WordPress XML-RPC API&amp;url=http://blog.dewhurstsecurity.com/2012/12/11/introduction-to-the-wordpress-xml-rpc-api.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.dewhurstsecurity.com/2012/12/11/introduction-to-the-wordpress-xml-rpc-api.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://blog.dewhurstsecurity.com/2012/12/11/introduction-to-the-wordpress-xml-rpc-api.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>
        	
        </footer>

    </article>

</main>


    <footer class="site-footer">
        <div class="inner">
            <section class="copyright">All content copyright <a href="http://blog.dewhurstsecurity.com">Dewhurst Security Blog</a> &copy;  &bull; All rights reserved.</section>
        </div>
    </footer>

    
    <script type="text/javascript" src="/assets/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3292649-12', 'auto');
      ga('send', 'pageview');
    </script>

</body>
</html>
